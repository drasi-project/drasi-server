# Drasi Platform Example - HTTP Requests
# Use with VSCode REST Client extension: https://marketplace.visualstudio.com/items?itemName=humao.rest-client

@baseUrl = http://localhost:8080
@sourceId = facilities-db
@queryId = room-comfort-level
@logReactionId = log-room-comfort-level
@platformReactionId = platform-hello-world-results

### Health Check
# Check if the Drasi server is running
GET {{baseUrl}}/health

### List API Versions
GET {{baseUrl}}/api/versions

### Get OpenAPI Specification
# View the complete API documentation
GET {{baseUrl}}/api/v1/openapi.json

### Swagger UI
# Interactive API documentation
GET {{baseUrl}}/api/v1/docs/

###############################################################################
# Sources
###############################################################################

### Get All Sources
GET {{baseUrl}}/api/v1/sources

### Get Platform Source Status
# Check the status of the platform Redis source
GET {{baseUrl}}/api/v1/sources/{{sourceId}}

### Stop Platform Source
# Stop consuming events from Redis
POST {{baseUrl}}/api/v1/sources/{{sourceId}}/stop

### Start Platform Source
# Resume consuming events from Redis
POST {{baseUrl}}/api/v1/sources/{{sourceId}}/start

###############################################################################
# Queries
###############################################################################

### Get All Queries
GET {{baseUrl}}/api/v1/queries

### Get Query Status
# Check the status of the hello-world query
GET {{baseUrl}}/api/v1/queries/{{queryId}}

### Get Query Results
# Retrieve current query results
GET {{baseUrl}}/api/v1/queries/{{queryId}}/results

### Stop Query
# Stop processing events for this query
POST {{baseUrl}}/api/v1/queries/{{queryId}}/stop

### Start Query
# Resume processing events for this query
POST {{baseUrl}}/api/v1/queries/{{queryId}}/start

###############################################################################
# Reactions
###############################################################################

### Get All Reactions
GET {{baseUrl}}/api/v1/reactions

### Get Log Reaction Status
# Check the status of the log reaction
GET {{baseUrl}}/api/v1/reactions/{{logReactionId}}

### Stop Log Reaction
# Stop logging query results to console
POST {{baseUrl}}/api/v1/reactions/{{logReactionId}}/stop

### Start Log Reaction
# Resume logging query results to console
POST {{baseUrl}}/api/v1/reactions/{{logReactionId}}/start

###############################################################################
# Platform Reaction
###############################################################################

### Get Platform Reaction Status
# Check the status of the platform reaction (publishes to Redis stream)
GET {{baseUrl}}/api/v1/reactions/{{platformReactionId}}

### Stop Platform Reaction
# Stop publishing query results to Redis stream (hello-world-from-results)
POST {{baseUrl}}/api/v1/reactions/{{platformReactionId}}/stop

### Start Platform Reaction
# Resume publishing query results to Redis stream
POST {{baseUrl}}/api/v1/reactions/{{platformReactionId}}/start

###############################################################################
# Testing Workflow
###############################################################################

### 1. Check All Components Are Running
# @name checkHealth
GET {{baseUrl}}/health

### 2. Verify Source Is Active
# @name checkSource
GET {{baseUrl}}/api/v1/sources/{{sourceId}}

### 3. View Current Results (Empty Initially)
# @name initialResults
GET {{baseUrl}}/api/v1/queries/{{queryId}}/results

### 4. Publish Event Using Script
# Run in terminal: ./examples/drasi-platform/scripts/publish-event.sh Alice

### 5. View Updated Results
# @name updatedResults
GET {{baseUrl}}/api/v1/queries/{{queryId}}/results

###############################################################################
# Advanced: Component Lifecycle Management
###############################################################################

### Stop All Components (Source → Query → Reactions)
POST {{baseUrl}}/api/v1/reactions/{{logReactionId}}/stop
###
POST {{baseUrl}}/api/v1/reactions/{{platformReactionId}}/stop
###
POST {{baseUrl}}/api/v1/queries/{{queryId}}/stop
###
POST {{baseUrl}}/api/v1/sources/{{sourceId}}/stop

### Start All Components (Source → Query → Reactions)
POST {{baseUrl}}/api/v1/sources/{{sourceId}}/start
###
POST {{baseUrl}}/api/v1/queries/{{queryId}}/start
###
POST {{baseUrl}}/api/v1/reactions/{{logReactionId}}/start
###
POST {{baseUrl}}/api/v1/reactions/{{platformReactionId}}/start
